<ng-template #content let-modal>
    <div class='w-50 rounded border border-secondary'>
        <div class="modal-header">
            <h4 class="modal-title" id="modal-basic-title">Update User Data</h4>
            <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
        <span aria-hidden="true">&times;</span>
      </button>
        </div>
        <form [formGroup]="userForm" (ngSubmit)="onSubmit()">
            <div class="modal-body">
                <div class=" form-row image-upload">
                    <div class="form-group">
                        <input *ngIf="selectedImage; else noImage" [style.backgroundImage]="'url('+ selectedImage +')'" type="file" formControlName="img" (change)="selectFile($event)" [ngClass]="{ 'is-invalid': submitted && f.img.errors} " />
                        <ng-template #noImage>
                            <input id='noimage-input' type="file" formControlName="img" (change)="selectFile($event)" [ngClass]="{ 'is-invalid': submitted && f.img.errors} " />
                        </ng-template>
                        <div *ngIf="submitted && f.img.errors " class="invalid-feedback">
                            <div *ngIf="f.img.errors.required ">Image is required</div>
                        </div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group col-md-6 ">
                        <label>Name</label>
                        <input type="text " class="form-control " formControlName="name" placeholder="Name" [ngClass]="{'is-invalid': submitted && f.name.errors} " />
                        <div *ngIf="submitted && f.name.errors " class="invalid-feedback ">
                            <div *ngIf="f.name.errors.required else name ">User name is required</div>
                            <ng-template #name>
                                <div *ngIf="f.name.errors.pattern ">name should contain letters only</div>
                            </ng-template>
                        </div>
                    </div>
                    <div class="form-group col-md-6 ">
                        <label>Email</label>
                        <input type="email" class="form-control " placeholder="example@domain.com" formControlName="email" [ngClass]="{ 'is-invalid': submitted && f.email.errors} " />
                        <div *ngIf="submitted && f.email.errors " class="invalid-feedback ">
                            <div *ngIf="f.email.errors.required else email ">Email is required</div>
                            <ng-template #email>
                                <div *ngIf="f.email.errors.email ">Email is not valid</div>
                            </ng-template>
                        </div>
                    </div>
                </div>
                <div class="form-row ">
                    <div class="form-group col-md-6 ">
                        <label>Role</label>
                        <input type="text" class="form-control " placeholder="Role" formControlName="role" [ngClass]="{ 'is-invalid': submitted && f.role.errors} " />
                        <div *ngIf="submitted && f.role.errors " class="invalid-feedback ">
                            <div *ngIf="f.role.errors.required ">Role is required</div>
                        </div>
                    </div>
                    <div class="form-group col-md-6 ">
                        <label>Status</label>
                        <input type="text" class="form-control " placeholder="Status" formControlName="status" [ngClass]="{ 'is-invalid': submitted && f.status.errors} " />
                        <div *ngIf="submitted && f.status.errors " class="invalid-feedback ">
                            <div *ngIf="f.status.errors.required ">Status is required</div>
                        </div>
                    </div>
                </div>
            </div>
        </form>
        <div class="modal-footer">
            <button type="button" class="btn btn-outline-dark" (click)="modal.close('Save click')">Save</button>
        </div>
    </div>
</ng-template>

<h1>Users Data</h1>
<table class="table">
    <thead>
        <tr>
            <th scope="col">ID</th>
            <th scope="col">Name</th>
            <th scope="col">Email</th>
            <th scope="col">Role</th>
            <th scope="col">Status</th>
            <th scope="col">Creation Date</th>
            <th scope="col"></th>
        </tr>
    </thead>
    <tbody>
        <tr *ngFor="let user of users">
            <th scope="row">{{user.$key}}</th>
            <td><img [src]="user.img">{{user.name}}</td>
            <td>{{user.email}}</td>
            <td>{{user.role}}</td>
            <td>{{user.status}}</td>
            <td>{{user.creationDate}}</td>
            <td class="row">
                <button class="btn btn-outline-danger col-5 mr-1 p-1" (click)='deleteUser(user)'>Delete</button>
                <button class="btn btn-outline-primary col-5 ml-1 p-1" (click)="open(content)">Edit</button>
                <!--updateUser(user)-->
            </td>
        </tr>
    </tbody>
</table>